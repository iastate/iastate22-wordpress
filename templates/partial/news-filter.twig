<div class="paragraph-widget paragraph-widget--filter-form">
    <div class="filter-form">
        <h2 class="filter-form__label">All Stories</h2>
        <form class="iastate22-form iastate22-form--inline" id="searchform" action="{{ site.link }}" method="get">
            <input type="hidden" name="post_type" value="post" tabindex="-1"/>
            <div class="form-item">
                <label for="name">Search</label>
                {# Post(function('get_option' ,'page_for_posts')).link #}
                <input class="iastate22-form--search" type="text" name="s" id="s" value="{{ function('get_search_query') }}" tabindex="1">
            </div>
            {% if categories|length > 0 %}
                <div class="form-item">
                    <label for="select-choice">Category</label>
                    <select class="iastate22-form--select" name="category_name" id="category_name">
                        <option value=""></option>
                        {% for term in categories %}    
                            <option value="{{ term.slug }}"
                            {% if function('get_query_var', 'category_name') == term.slug %}
                            selected
                            {% endif %}
                            >{{ term.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            {% endif %}
            
            {% if tags|length > 0 %}
            <div class="form-item">
                <label for="select-choice">Tag</label>
                <select class="iastate22-form--select" name="tag" id="tag">
                    <option value=""></option>
                    {% for term in tags %}    
                            <option value="{{ term.slug }}"
                            {% if function('get_query_var', 'tag') == term.slug %}
                            selected
                            {% endif %}
                            >{{ term.name }}</option>
                        {% endfor %}
                </select>
            </div>
            {% endif %}
            <div class="form-item">
                <button type="submit">Search<span class="arrow"></span>
                </button>
            </div>
            <p class="filter-form-results">About {{ posts.found_posts }} Results â€¢ <button type="reset">Reset</button></p>
        </form>
        <script type="text/javascript">
                console.log("If you see this, it needs to be moved to the front end library");
                let frm = document.querySelector('#searchform'),
                    reset = document.querySelector('.filter-form-results button[type=reset]');

                reset.addEventListener('click', function(e) {
                    e.preventDefault();
                    let srch = frm.querySelector('input#s'),
                        selct = frm.querySelectorAll('select');
                    srch.setAttribute('value', '');
                    selct.forEach((el, i)=> {
                        el.querySelectorAll('option').forEach((o, i)=> {
                            o.removeAttribute('selected');
                        });
                        el.value = "";
                        el.selectedIndex = 0;
                    });
                    frm.reset();
                    frm.submit();
                });
            </script>
    </div>
</div>